<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ù…Ø§Ø´ÛŒÙ†â€ŒØ­Ø³Ø§Ø¨ Ø³ÙˆØ¯ Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±ÛŒ Ø±ÛŒÙ¾ÛŒ â€“ Ø¨Ù„Ú© ÙØ±Ø§ÛŒØ¯ÛŒ</title>
  <style>
    :root{
      --bg:#050509;
      --card:#090910;
      --ink:#f5f3ff;
      --muted:#b0a6d6;
      --primary:#f9d976;      /* Ø·Ù„Ø§ÛŒÛŒ Ø¨Ø±Ø§ÛŒ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ */
      --primary-text:#1a132a; /* Ø±Ù†Ú¯ Ù…ØªÙ† Ø±ÙˆÛŒ Ø¯Ú©Ù…Ù‡ Ø·Ù„Ø§ÛŒÛŒ */
      --accent:#ff0044;       /* Ù‚Ø±Ù…Ø² Ø¨Ù„Ú© ÙØ±Ø§ÛŒØ¯ÛŒ */
      --border:rgba(249,217,118,0.4);
      --radius:22px;
      --shadow:0 18px 40px rgba(0,0,0,.75);
    }

    *{box-sizing:border-box}

    body{
      font-family:IranSans,system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
      background:
        radial-gradient(circle at top, #22142f 0, #050509 55%, #020105 100%),
        repeating-linear-gradient(135deg,
          rgba(249,217,118,0.10) 0,
          rgba(249,217,118,0.10) 1px,
          transparent 1px,
          transparent 14px);
      color:var(--ink);
      margin:0;
      padding:0;
      min-height:100vh;
      overflow-x:hidden;
    }

    .container{
      position:relative;
      max-width:480px;
      background:radial-gradient(circle at top left,#181227 0,#090910 55%,#050308 100%);
      margin:28px auto;
      padding:24px 22px 26px;
      border-radius:calc(var(--radius) + 4px);
      box-shadow:var(--shadow);
      border:1px solid var(--border);
      overflow:hidden;
      z-index:10;
    }

    .container::before{
      content:"";
      position:absolute;
      inset:-40%;
      background:
        conic-gradient(from 220deg,
          rgba(249,217,118,0.0) 0deg,
          rgba(249,217,118,0.12) 80deg,
          rgba(249,217,118,0.0) 140deg,
          rgba(249,217,118,0.16) 220deg,
          rgba(249,217,118,0.0) 300deg);
      opacity:0.45;
      mix-blend-mode:screen;
      pointer-events:none;
    }

    .container-inner{
      position:relative;
      z-index:1;
    }

    .center{text-align:center}

    img.logo{
      width:90px;
      display:block;
      margin:0 auto 10px;
      filter:drop-shadow(0 0 10px rgba(0,0,0,.6));
    }

    h1{
      font-size:22px;
      margin:10px 0 4px;
    }

    .bf-tagline{
      display:inline-flex;
      align-items:center;
      gap:6px;
      font-size:13px;
      color:var(--muted);
      background:rgba(255,0,68,0.12);
      border-radius:999px;
      padding:4px 10px;
      margin-bottom:10px;
      border:1px solid rgba(255,0,68,0.35);
    }

    .bf-tagline span.dot{
      width:7px;
      height:7px;
      border-radius:999px;
      background:var(--accent);
      box-shadow:0 0 8px rgba(255,0,68,0.7);
    }

    p{
      font-size:14px;
      margin:0 0 10px;
      line-height:1.9;
    }

    .note{
      font-size:12px;
      color:var(--muted);
      margin:0 0 6px;
      line-height:1.8;
    }

    .row{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:10px;
      margin-top:6px;
    }

    .row.onecol{
      grid-template-columns:1fr;
    }

    label.mini{
      font-size:12px;
      color:var(--muted);
      display:block;
      margin:4px 2px;
    }

    select,
    input[type="text"]{
      width:100%;
      padding:11px 11px;
      margin-bottom:10px;
      font-size:14px;
      border-radius:13px;
      border:1px solid rgba(255,255,255,0.14);
      text-align:right;
      background:rgba(10,10,18,0.92);
      color:var(--ink);
      transition:border-color 0.15s ease, box-shadow 0.15s ease, background 0.15s ease, transform 0.05s ease;
    }

    input[type="text"]{direction:ltr}

    select:focus,
    input[type="text"]:focus{
      border-color:var(--primary);
      box-shadow:0 0 0 1px rgba(249,217,118,0.6);
      outline:none;
      background:rgba(14,14,24,0.98);
    }

    input[aria-invalid="true"]{
      border-color:#ff4a4a;
      box-shadow:0 0 0 1px rgba(255,74,74,0.6);
    }

    .error{
      color:#ff6b7f;
      font-size:12px;
      min-height:18px;
      margin:-4px 0 10px;
    }

    .result{
      background:linear-gradient(145deg,rgba(22,18,36,0.96),rgba(8,6,18,0.98));
      padding:16px 14px;
      border-radius:16px;
      line-height:1.9;
      white-space:pre-line;
      min-height:80px;
      font-size:14px;
      border:1px solid rgba(249,217,118,0.24);
      box-shadow:0 0 0 1px rgba(0,0,0,0.85);
      margin-top:4px;
    }

    .btn{
      background:linear-gradient(135deg,#f9e19c,#f9d976,#f5c35c);
      color:var(--primary-text);
      border:none;
      padding:13px 14px;
      font-size:15px;
      font-weight:600;
      border-radius:999px;
      cursor:pointer;
      width:100%;
      margin:8px 0 10px;
      transition:box-shadow 0.15s ease, transform 0.08s ease, filter 0.12s ease;
    }

    .btn:hover{
      box-shadow:0 10px 26px rgba(0,0,0,.7);
      filter:brightness(1.05);
    }

    .btn:active{
      transform:translateY(1px) scale(0.99);
      box-shadow:none;
    }

    .btn[disabled]{
      opacity:0.6;
      cursor:not-allowed;
      box-shadow:none;
      filter:grayscale(0.2);
    }

    .btn-ghost{
      background:rgba(10,10,18,0.9);
      color:var(--ink);
      border:1px solid rgba(255,255,255,0.18);
      font-weight:500;
    }

    .btn-ghost:hover{
      background:rgba(36,28,58,0.98);
    }

    .btn-secondary{
      background:rgba(10,10,18,0.95);
      color:var(--primary);
      border:1px solid rgba(249,217,118,0.5);
      font-weight:500;
    }

    .actions{
      display:flex;
      gap:8px;
      margin-top:10px;
    }

    .actions .btn{
      flex:1;
      padding:10px 0;
      margin:0;
      border-radius:999px;
      font-size:13px;
    }

    a.btn-primary{
      display:block;
      text-decoration:none;
      text-align:center;
      background:linear-gradient(135deg,#f9e19c,#f9d976,#f5c35c);
      color:var(--primary-text);
      border-radius:999px;
      padding:13px 14px;
      margin:8px 0 4px;
      font-size:15px;
      font-weight:600;
      box-shadow:0 10px 26px rgba(0,0,0,.7);
      transition:box-shadow 0.15s ease, transform 0.08s ease, filter 0.12s ease;
    }

    a.btn-primary:hover{
      filter:brightness(1.05);
    }

    a.btn-primary:active{
      transform:translateY(1px) scale(0.99);
      box-shadow:none;
    }

    .usage-counter{
      margin-top:10px;
      font-size:12px;
      color:var(--muted);
      text-align:center;
    }

    /* Download modal (glass) */

    .download-trigger{
      margin-top:10px;
    }

    .modal{
      position:fixed;
      inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      z-index:100;
    }

    .modal.active{
      display:flex;
    }

    .modal::before{
      content:"";
      position:absolute;
      inset:0;
      background:rgba(0,0,0,0.72);
      backdrop-filter:blur(10px);
    }

    .modal-box{
      position:relative;
      max-width:360px;
      width:86%;
      background:linear-gradient(145deg,rgba(22,18,36,0.92),rgba(8,6,18,0.96));
      border-radius:20px;
      padding:18px 16px 16px;
      border:1px solid rgba(249,217,118,0.5);
      box-shadow:0 20px 40px rgba(0,0,0,0.9);
      z-index:1;
    }

    .modal-header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:8px;
    }

    .modal-title{
      font-size:14px;
      font-weight:600;
    }

    .modal-close{
      background:transparent;
      color:var(--muted);
      border:none;
      cursor:pointer;
      font-size:18px;
      line-height:1;
      padding:2px 6px;
    }

    .modal-body{
      margin-top:4px;
    }

    .download-list{
      display:flex;
      flex-direction:column;
      gap:8px;
      margin-top:6px;
    }

    .download-item{
      display:flex;
      align-items:center;
      gap:10px;
      text-decoration:none;
      padding:8px 10px;
      border-radius:14px;
      background:rgba(12,10,22,0.96);
      border:1px solid rgba(255,255,255,0.1);
      transition:background 0.15s ease, transform 0.08s ease, border-color 0.15s ease;
    }

    .download-item:hover{
      background:rgba(26,18,44,0.98);
      border-color:rgba(249,217,118,0.5);
      transform:translateY(-1px);
    }

    .download-icon{
      width:28px;
      height:28px;
      border-radius:8px;
      object-fit:contain;
      background:#fff;
      flex-shrink:0;
    }

    .download-text-main{
      font-size:13px;
      color:var(--ink);
      display:block;
    }

    .download-text-sub{
      font-size:11px;
      color:var(--muted);
      display:block;
    }

    /* Balloons & coins layers */

    .balloon-layer,
    .coin-layer{
      position:fixed;
      inset:0;
      pointer-events:none;
      overflow:hidden;
      z-index:5;
    }

    .coin-layer{
      z-index:60;
    }

    .balloon{
      position:absolute;
      bottom:-60px;
      width:34px;
      height:46px;
      background:radial-gradient(circle at 30% 30%, #ffd3e0 0, #ff0044 55%, #7a001f 100%);
      border-radius:50% 50% 45% 45%;
      box-shadow:0 0 14px rgba(255,0,80,0.7);
      animation:balloon-up 12s linear forwards;
    }

    .balloon::after{
      content:"";
      position:absolute;
      left:50%;
      bottom:-26px;
      width:1px;
      height:28px;
      background:rgba(255,255,255,0.7);
      transform:translateX(-50%);
      opacity:0.7;
    }

    @keyframes balloon-up{
      0%{transform:translateY(0);opacity:0;}
      10%{opacity:1;}
      100%{transform:translateY(-115vh);opacity:0;}
    }

    .coin{
      position:absolute;
      top:-40px;
      width:22px;
      height:22px;
      border-radius:50%;
      background:radial-gradient(circle at 30% 30%, #fff7cc 0, #f6c453 40%, #b57b1a 100%);
      box-shadow:0 0 10px rgba(249,217,118,0.85);
      border:1px solid rgba(184,135,11,0.9);
      animation:coin-fall 1.1s linear forwards;
    }

    @keyframes coin-fall{
      0%{transform:translateY(0) rotateZ(0deg) scale(0.9);opacity:0;}
      10%{opacity:1;}
      100%{transform:translateY(110vh) rotateZ(540deg) scale(1.05);opacity:0;}
    }

    @media (max-width:480px){
      .container{
        margin:16px;
        padding:20px 16px 22px;
      }
    }
  </style>
</head>
<body>
  <!-- Ù„Ø§ÛŒÙ‡â€ŒÙ‡Ø§ÛŒ Ø§ÙÚ©Øª -->
  <div class="balloon-layer" aria-hidden="true"></div>
  <div class="coin-layer" aria-hidden="true"></div>

  <div class="container">
    <div class="container-inner">
      <div class="center">
        <img src="https://uploadkon.ir/uploads/8c7604_25file-0000000073346243969ca320550ec0a2.png" class="logo" alt="Repay Logo" />
        <div class="bf-tagline">
          <span class="dot"></span>
          <span>Ø¨Ù„Ú© ÙØ±Ø§ÛŒØ¯ÛŒ Ø±ÛŒÙ¾ÛŒ â€“ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø³Ø±ÛŒØ¹ Ø³ÙˆØ¯ Ùˆ Ù‡Ø¯ÛŒÙ‡ Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±ÛŒ</span>
        </div>
        <h1>Ù…Ø§Ø´ÛŒÙ† Ø­Ø³Ø§Ø¨ Ø³ÙˆØ¯ Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±ÛŒ</h1>
        <p>Ø§Ø² Ø¨Ø§Ú©Ø³ Â«Ø·Ø±Ø­â€ŒÙ‡Ø§Â» Ú¯Ø²ÛŒÙ†Ù‡ Ù…ÙˆØ±Ø¯Ù†Ø¸Ø± Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯Ø› Ø§Ú¯Ø± Ø²ÛŒØ±Ù…Ø¬Ù…ÙˆØ¹Ù‡ Ø¯Ø§Ø´ØªØŒ Ø¨Ø§Ú©Ø³ Ø¯ÙˆÙ… ÙØ¹Ø§Ù„ Ù…ÛŒâ€ŒØ´ÙˆØ¯ØŒ Ø³Ù¾Ø³ Ù…Ø¨Ù„Øº Ø³Ø±Ù…Ø§ÛŒÙ‡ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ø±Ø¯Ù‡ Ùˆ Ø±ÙˆÛŒ Â«Ù…Ø­Ø§Ø³Ø¨Ù‡Â» Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯.</p>
      </div>

      <p class="note">
        Ø¯Ø± Ø·Ø±Ø­ Ø¨Ù„Ú© ÙØ±Ø§ÛŒØ¯ÛŒ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø¨ÛŒÙ† Ø¯Ùˆ Ú¯Ø²ÛŒÙ†Ù‡ Û¶Û±Ùª (Û±Û²Ù…Ø§Ù‡Ù‡) Ùˆ Û±Û²Û¶Ùª (Û²Û´Ù…Ø§Ù‡Ù‡) Ø¨Ø§ Ø­Ø¯Ø§Ù‚Ù„ Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±ÛŒ Û¹Ù«Û°Û°Û°Ù«Û°Û°Û° ØªÙˆÙ…Ø§Ù† ÛŒÚ©ÛŒ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯.
      </p>
      <p class="note">
        Ø¨Ø§ Ø´Ø±Ú©Øª Ø¯Ø± Ø·Ø±Ø­â€ŒÙ‡Ø§ÛŒ Ø·Ù„Ø§ÛŒÛŒØŒ Ø¯Ø± Â«Ø·Ø±Ø­ Ù‡Ø¯ÛŒÙ‡ Ø¨Ù„Ú© ÙØ±Ø§ÛŒØ¯ÛŒÂ» Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ ØªØ§ Ø³Ù‚Ù Û¹Û°Ù«Û°Û°Û°Ù«Û°Û°Û° ØªÙˆÙ…Ø§Ù† Ù‡Ø¯ÛŒÙ‡ Ù†Ù‚Ø¯ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ú©Ù†ÛŒØ¯.
      </p>
      <p class="note">
        Ø¯Ø± ØµÙˆØ±Øª Ø§Ù†ØªØ®Ø§Ø¨ Ø·Ø±Ø­ Ø·Ù„Ø§ÛŒÛŒ Û±Û±Û´ÙªØŒ Ø¹Ù„Ø§ÙˆÙ‡ Ø¨Ø± Ù‡Ø¯ÛŒÙ‡Ù” ÙÙˆÙ‚ØŒ Ù¾Ø§Ø¯Ø§Ø´ Ù†Ù‚Ø¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ù…Ø¹Ø§Ø¯Ù„ Û³Ùª Ø§Ø² Ú©Ù„ Ù…Ø¨Ù„Øº Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±ÛŒâ€ŒØ´Ø¯Ù‡ Ù†ÛŒØ² Ø¨Ù‡ Ø´Ù…Ø§ ØªØ¹Ù„Ù‚ Ù…ÛŒâ€ŒÚ¯ÛŒØ±Ø¯.
      </p>

      <!-- Ø·Ø±Ø­â€ŒÙ‡Ø§ + Ø²ÛŒØ±Ø·Ø±Ø­ -->
      <div class="row" id="planRow">
        <div id="catWrap">
          <label class="mini" for="category">Ø·Ø±Ø­â€ŒÙ‡Ø§</label>
          <select id="category" aria-label="Ø·Ø±Ø­â€ŒÙ‡Ø§"></select>
        </div>
        <div id="subWrap">
          <label class="mini" for="subplan">Ø§Ù†ØªØ®Ø§Ø¨ Ø²ÛŒØ±Ø·Ø±Ø­ (Ù…Ø¯Øª/Ø¯Ø±ØµØ¯)</label>
          <select id="subplan" aria-label="Ø²ÛŒØ±Ø·Ø±Ø­"></select>
        </div>
      </div>

      <!-- Ù…Ø¨Ù„Øº -->
      <label class="mini" for="amount">Ù…Ø¨Ù„Øº Ø³Ø±Ù…Ø§ÛŒÙ‡ (ØªÙˆÙ…Ø§Ù†)</label>
      <input
        id="amount"
        type="text"
        inputmode="numeric"
        pattern="[0-9]*"
        autocomplete="off"
        placeholder="Ù…Ø¨Ù„Øº Ø³Ø±Ù…Ø§ÛŒÙ‡ (ØªÙˆÙ…Ø§Ù†)"
        aria-invalid="false"
      />
      <div id="amountError" class="error" aria-live="polite"></div>

      <button id="calcBtn" class="btn" type="button">Ù…Ø­Ø§Ø³Ø¨Ù‡</button>

      <div class="result" id="result" aria-live="polite"></div>

      <div class="actions">
        <button id="btnCopy" class="btn btn-ghost" type="button">ğŸ“‹ Ú©Ù¾ÛŒ Ù†ØªÛŒØ¬Ù‡</button>
        <button id="btnShare" class="btn btn-ghost" type="button">ğŸ“¤ Ø§Ø´ØªØ±Ø§Ú©â€ŒÚ¯Ø°Ø§Ø±ÛŒ</button>
      </div>

      <!-- Ø¯Ú©Ù…Ù‡ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø§Ù¾Ù„ÛŒÚ©ÛŒØ´Ù† -->
      <div class="download-trigger">
        <button id="btnDownload" class="btn btn-secondary" type="button">ğŸ“± Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø§Ù¾Ù„ÛŒÚ©ÛŒØ´Ù†</button>
      </div>

      <!-- Ø¯Ú©Ù…Ù‡ Ø§ØµÙ„ÛŒ Ø´Ø±ÙˆØ¹ -->
      <a
        id="ctaStart"
        class="btn-primary"
        href="https://my.repay.pro"
        target="_blank"
        rel="noreferrer noopener"
      >Ù‡Ù…ÛŒÙ† Ø§Ù„Ø§Ù† Ø´Ø±ÙˆØ¹ Ú©Ù†</a>

      <div class="usage-counter">
        ğŸ“Š ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„ Ù…Ø­Ø§Ø³Ø¨Ù‡â€ŒÙ‡Ø§ÛŒ Ø«Ø¨Øªâ€ŒØ´Ø¯Ù‡ Ø¨Ø§ Ø§ÛŒÙ† Ù…Ø§Ø´ÛŒÙ†â€ŒØ­Ø³Ø§Ø¨: <span id="useCount">0</span>
      </div>
    </div>
  </div>

  <!-- Ù…ÙˆØ¯Ø§Ù„ Ø´ÛŒØ´Ù‡â€ŒØ§ÛŒ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø§Ù¾Ù„ÛŒÚ©ÛŒØ´Ù† -->
  <div id="downloadModal" class="modal" aria-hidden="true">
    <div class="modal-box">
      <div class="modal-header">
        <div class="modal-title">Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø§Ù¾Ù„ÛŒÚ©ÛŒØ´Ù† Ø±ÛŒÙ¾ÛŒ</div>
        <button type="button" class="modal-close" id="downloadClose" aria-label="Ø¨Ø³ØªÙ†">Ã—</button>
      </div>
      <div class="modal-body">
        <p class="note" style="margin-bottom:6px;">Ù†Ø³Ø®Ù‡ Ø§Ù¾Ù„ÛŒÚ©ÛŒØ´Ù† Ø±Ø§ Ø§Ø² Ù…Ø§Ø±Ú©Øªâ€ŒÙ‡Ø§ÛŒ Ù…Ø¹ØªØ¨Ø± ÛŒØ§ Ù†Ø³Ø®Ù‡ ÙˆØ¨â€ŒØ§Ù¾Ù„ÛŒÚ©ÛŒØ´Ù† Ø§Ø¬Ø±Ø§ Ú©Ù†ÛŒØ¯:</p>
        <div class="download-list">
          <a
            class="download-item"
            href="https://cafebazaar.ir/app/YOUR_APP_ID"
            target="_blank"
            rel="noreferrer noopener"
          >
            <img
              class="download-icon"
              src="https://webassets.cafebazaar.ir/images/bazaar-logo.svg"
              alt="Cafe Bazaar"
            />
            <div>
              <span class="download-text-main">Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø§Ø² Ú©Ø§ÙÙ‡â€ŒØ¨Ø§Ø²Ø§Ø±</span>
              <span class="download-text-sub">Ø¨Ø§Ø²Ø§Ø± Ø§Ù¾Ù„ÛŒÚ©ÛŒØ´Ù† Ø§Ù†Ø¯Ø±ÙˆÛŒØ¯</span>
            </div>
          </a>

          <a
            class="download-item"
            href="https://myket.ir/app/YOUR_APP_ID"
            target="_blank"
            rel="noreferrer noopener"
          >
            <!-- Ø§ÛŒÙ† Ù„ÙˆÚ¯Ùˆ Ø±Ø§ Ø¯Ø± ØµÙˆØ±Øª Ù†ÛŒØ§Ø² Ø¨Ø§ Ø¢Ø¯Ø±Ø³ Ø±Ø³Ù…ÛŒ Ù…Ø§ÛŒÚ©Øª Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† Ú©Ù†ÛŒØ¯ -->
            <img
              class="download-icon"
              src="https://static.cdnlogo.com/logos/m/24/myket.svg"
              alt="Myket"
            />
            <div>
              <span class="download-text-main">Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø§Ø² Ù…Ø§ÛŒÚ©Øª</span>
              <span class="download-text-sub">Ù…Ø§Ø±Ú©Øª Ø§Ù†Ø¯Ø±ÙˆÛŒØ¯ÛŒ Ù…Ø§ÛŒÚ©Øª</span>
            </div>
          </a>

          <a
            class="download-item"
            href="https://my.repay.pro"
            target="_blank"
            rel="noreferrer noopener"
          >
            <div
              class="download-icon"
              style="display:flex;align-items:center;justify-content:center;background:radial-gradient(circle at 30% 30%,#ffe7ba 0,#f9d976 45%,#b57b1a 100%);color:#1a132a;font-weight:700;font-size:15px;"
            >W</div>
            <div>
              <span class="download-text-main">ÙˆØ¨â€ŒØ§Ù¾Ù„ÛŒÚ©ÛŒØ´Ù† Ø±ÛŒÙ¾ÛŒ</span>
              <span class="download-text-sub">Ø§Ø¬Ø±Ø§ Ø§Ø² Ø·Ø±ÛŒÙ‚ Ù…Ø±ÙˆØ±Ú¯Ø± (Ø¨Ø¯ÙˆÙ† Ù†ØµØ¨)</span>
            </div>
          </a>
        </div>
      </div>
    </div>
  </div>

  <script>
    // =======================
    // Catalog of plans
    // =======================
    const catalog = {
      special: {
        type: 'group',
        label: 'ğŸ† Ø·Ø±Ø­ ÙˆÛŒÚ˜Ù‡ (Ø·Ù„Ø§ÛŒÛŒ)',
        children: {
          gold114: { label: "ğŸ… Ø·Ù„Ø§ÛŒÛŒ Û±Û±Û´Ùª (Û²Û´Ù…Ø§Ù‡Ù‡)", type: "termYield", termMonths: 24, termYield: 1.14, min: 5_000_000 },
          gold52:  { label: "ğŸ… Ø·Ù„Ø§ÛŒÛŒ ÛµÛ²Ùª (Û±Û²Ù…Ø§Ù‡Ù‡)",  type: "termYield", termMonths: 12, termYield: 0.52, min: 5_000_000 },
          gold25:  { label: "ğŸ… Ø·Ù„Ø§ÛŒÛŒ Û²ÛµÙª (Û¶Ù…Ø§Ù‡Ù‡)",   type: "termYield", termMonths: 6,  termYield: 0.25, min: 5_000_000 },
          gold9:   { label: "ğŸ… Ø·Ù„Ø§ÛŒÛŒ Û¹Ùª (Û³Ù…Ø§Ù‡Ù‡)",    type: "termYield", termMonths: 3,  termYield: 0.09, min: 5_000_000 },
        }
      },
      blackFriday: {
        type: 'group',
        label: 'ğŸ–¤ Ø·Ø±Ø­ Ø¨Ù„Ú© ÙØ±Ø§ÛŒØ¯ÛŒ',
        children: {
          bf61:  { label: "ğŸ–¤ Ø¨Ù„Ú© ÙØ±Ø§ÛŒØ¯ÛŒ Û¶Û±Ùª (Û±Û²Ù…Ø§Ù‡Ù‡)",  type: "termYield", termMonths: 12, termYield: 0.61, min: 9_000_000 },
          bf126: { label: "ğŸ–¤ Ø¨Ù„Ú© ÙØ±Ø§ÛŒØ¯ÛŒ Û±Û²Û¶Ùª (Û²Û´Ù…Ø§Ù‡Ù‡)", type: "termYield", termMonths: 24, termYield: 1.26, min: 9_000_000 },
        }
      },
      hamrahi: {
        type: 'comingSoon',
        label: 'â™¥ï¸ Ø·Ø±Ø­ Ù‡Ù…Ø±Ø§Ù‡ÛŒ (Ø¨Ø²ÙˆØ¯ÛŒ)'
      }
    };

    // Ù‡Ø¯ÛŒÙ‡ Ø¨Ù„Ú© ÙØ±Ø§ÛŒØ¯ÛŒ
    const GIFT_CAP = 90_000_000; // Ø³Ù‚Ù Ù‡Ø¯ÛŒÙ‡ Û¹Û° Ù…ÛŒÙ„ÛŒÙˆÙ†

    // =======================
    // Number formatting & input utils
    // =======================
    const nfFA = new Intl.NumberFormat('fa-IR');
    const formatNumber = (n) => nfFA.format(n);

    function normalizeDigits(str){
      const fa='Û°Û±Û²Û³Û´ÛµÛ¶Û·Û¸Û¹', ar='Ù Ù¡Ù¢Ù£Ù¤Ù¥Ù¦Ù§Ù¨Ù©';
      return (str||'').replace(/[\u06F0-\u06F9\u0660-\u0669]/g,d=>{
        const i=fa.indexOf(d); if(i>-1) return String(i);
        const j=ar.indexOf(d); if(j>-1) return String(j);
        return d;
      });
    }

    function numberFromInput(val){
      const normalized = normalizeDigits(val);
      const raw = normalized.replace(/[^\d]/g,'');
      return raw ? Math.min(parseInt(raw,10), Number.MAX_SAFE_INTEGER) : NaN;
    }

    function formatInputAmount(e){
      const input=e.target;
      const n=numberFromInput(input.value);
      if(Number.isNaN(n)){ input.value=''; return; }
      input.value = formatNumber(n);
    }

    function setError(msg){
      const el = document.getElementById('amountError');
      const inp = document.getElementById('amount');
      el.textContent = msg || '';
      inp.setAttribute('aria-invalid', msg ? 'true' : 'false');
    }

    // =======================
    // Core financial calculation (simple total yield)
    // =======================
    function calcTermYield(P, termYield, termMonths){
      const profit = Math.round(P * termYield);
      const monthly = Math.round(profit / termMonths);
      return { profit, monthly, finalAmount: P + profit };
    }

    // Ù‡Ø¯ÛŒÙ‡ Ø¨Ù„Ú© ÙØ±Ø§ÛŒØ¯ÛŒ Ø¨Ø±Ø§ÛŒ Ø·Ø±Ø­â€ŒÙ‡Ø§ÛŒ Ø·Ù„Ø§ÛŒÛŒ (Ù…Ù†Ø·Ù‚ Ø¯Ø§Ø®Ù„ÛŒ â€“ Ø¯Ø± UI ÙÙ‚Ø· Ù…Ø¨Ù„Øº Ù‡Ø¯ÛŒÙ‡ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯)
    function calcGift(amount, catKey, subKey){
      if (catKey !== 'special') return null; // ÙÙ‚Ø· Ø·Ø±Ø­â€ŒÙ‡Ø§ÛŒ Ø·Ù„Ø§ÛŒÛŒ
      const baseGift = Math.min(Math.round(amount * 0.06), GIFT_CAP); // Û¶Ùª ØªØ§ Ø³Ù‚Ù Û¹Û°M
      let extraGift = 0;
      if (subKey === 'gold114') {
        // Û³Ùª Ø§Ø¶Ø§ÙÙ‡ Ù…Ø®ØµÙˆØµ Ø·Ø±Ø­ Û±Û±Û´Ùª
        extraGift = Math.round(amount * 0.03);
      }
      const totalGift = baseGift + extraGift;
      if (totalGift <= 0) return null;
      return { baseGift, extraGift, totalGift };
    }

    // =======================
    // UI helpers
    // =======================
    function updateAmountPlaceholder(min){
      const txt = min>0 ? `Ø­Ø¯Ø§Ù‚Ù„ Ù…Ø¨Ù„Øº ${formatNumber(min)} ØªÙˆÙ…Ø§Ù†` : 'Ù…Ø¨Ù„Øº Ø³Ø±Ù…Ø§ÛŒÙ‡ (ØªÙˆÙ…Ø§Ù†)';
      document.getElementById('amount').placeholder = txt;
    }

    function updateCtaLink(params = {}){
      const a = document.getElementById('ctaStart');
      const url = new URL('https://my.repay.pro');
      Object.entries(params).forEach(([k,v])=>{
        if(v!==undefined && v!==null && v!=='') url.searchParams.set(k,String(v));
      });
      a.href = url.toString();
    }

    function setRowCols(hasSub){
      const row = document.getElementById('planRow');
      row.classList.toggle('onecol', !hasSub);
      document.getElementById('subWrap').style.display = hasSub ? '' : 'none';
    }

    function getSelectedCategory() {
      const key = document.getElementById('category').value;
      return catalog[key];
    }

    function getSelectedPlan() {
      const catKey = document.getElementById('category').value;
      const subKey = document.getElementById('subplan').value;
      const cat = catalog[catKey];
      if (!cat || cat.type !== 'group') return null;
      const plan = cat.children?.[subKey];
      return plan ? { catKey, subKey, plan } : null;
    }

    // =======================
    // Global usage counter via Apps Script
    // =======================
    // Ø§ÛŒÙ† URL Ø±Ø§ Ø¨Ø§ Web App URL ÙˆØ§Ù‚Ø¹ÛŒ Google Apps Script Ø®ÙˆØ¯ØªØ§Ù† Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† Ú©Ù†ÛŒØ¯:
    const COUNTER_API_URL = 'https://script.google.com/macros/s/AKfycby5-PGZe8ukx8bcEu_W2W50jehX1owKv0MWmsbVeOT1Th7MHDDDv_T15ncRMBzhzlGo/exec';
    const COUNTER_NS  = 'repay_calc';
    const COUNTER_KEY = 'usage_count';

    async function fetchUseCountFromServer() {
      const span = document.getElementById('useCount');
      try {
        const url = `${COUNTER_API_URL}?op=get&ns=${encodeURIComponent(COUNTER_NS)}&key=${encodeURIComponent(COUNTER_KEY)}`;
        const res = await fetch(url, {
          method: 'GET',
          headers: { 'Accept': 'application/json' }
        });
        if (!res.ok) throw new Error('Bad response');

        const data = await res.json();
        const count = Number(data.value);
        span.textContent = Number.isFinite(count) && count >= 0 ? count : '0';
      } catch (e) {
        console.error('Failed to fetch global usage count', e);
        if (!span.textContent) span.textContent = '0';
      }
    }

    async function incrementUseCountOnServer() {
      const span = document.getElementById('useCount');
      try {
        const url = `${COUNTER_API_URL}?op=hit&ns=${encodeURIComponent(COUNTER_NS)}&key=${encodeURIComponent(COUNTER_KEY)}&v=1`;
        const res = await fetch(url, {
          method: 'GET',
          headers: { 'Accept': 'application/json' }
        });
        if (!res.ok) throw new Error('Bad response');

        const data = await res.json();
        const count = Number(data.value);
        if (Number.isFinite(count) && count >= 0) {
          span.textContent = count;
        }
      } catch (e) {
        console.error('Failed to increment global usage count', e);
      }
    }

    // =======================
    // Balloons & coins
    // =======================
    const balloonLayer = document.querySelector('.balloon-layer');
    const coinLayer = document.querySelector('.coin-layer');

    function spawnBalloon(){
      if (!balloonLayer) return;
      const el = document.createElement('div');
      el.className = 'balloon';
      el.style.left = (5 + Math.random()*90) + '%';
      el.style.animationDuration = (10 + Math.random()*6) + 's';
      balloonLayer.appendChild(el);
      setTimeout(()=>{ el.remove(); }, 17000);
    }

    function triggerCoinRain(){
      if (!coinLayer) return;
      const count = 9 + Math.floor(Math.random()*4);
      for (let i=0;i<count;i++){
        const c = document.createElement('div');
        c.className = 'coin';
        c.style.left = (5 + Math.random()*90) + '%';
        c.style.animationDelay = (Math.random()*0.2) + 's';
        coinLayer.appendChild(c);
        setTimeout(()=>{ c.remove(); }, 1300);
      }
    }

    // =======================
    // Plan selection logic
    // =======================
    function fillCategories(){
      const catSel = document.getElementById('category');
      catSel.innerHTML = '';
      // ØªØ±ØªÛŒØ¨: Ø¨Ù„Ú©â€ŒÙØ±Ø§ÛŒØ¯ÛŒØŒ Ø·Ù„Ø§ÛŒÛŒØŒ Ù‡Ù…Ø±Ø§Ù‡ÛŒ
      ['blackFriday','special','hamrahi'].forEach(key=>{
        const obj = catalog[key];
        const opt = document.createElement('option');
        opt.value = key;
        opt.textContent = obj.label;
        catSel.appendChild(opt);
      });
    }

    function onCategoryChange(){
      const catSel = document.getElementById('category');
      const catKey = catSel.value;
      const cat = catalog[catKey];
      const subSel = document.getElementById('subplan');
      const calcBtn = document.getElementById('calcBtn');
      const resultEl = document.getElementById('result');

      subSel.innerHTML = '';
      setError('');
      resultEl.textContent = '';

      if(cat && cat.type === 'group'){
        Object.entries(cat.children).forEach(([k,pl])=>{
          const opt=document.createElement('option');
          opt.value = k;
          opt.textContent = pl.label;
          subSel.appendChild(opt);
        });
        setRowCols(true);
        const firstKey = Object.keys(cat.children)[0];
        subSel.value = firstKey;
        const chosen = cat.children[firstKey];
        updateAmountPlaceholder(chosen.min);
        calcBtn.disabled = false;
        updateCtaLink({category: catKey, sub: firstKey});
      }else{
        // Ø·Ø±Ø­ ØºÛŒØ± ÙØ¹Ø§Ù„ (Ù‡Ù…Ø±Ø§Ù‡ÛŒ)
        setRowCols(false);
        calcBtn.disabled = true;
        updateAmountPlaceholder(0);
        resultEl.textContent = 'Ø§ÛŒÙ† Ø·Ø±Ø­ Ø¯Ø± Ø­Ø§Ù„ Ø­Ø§Ø¶Ø± ÙØ¹Ø§Ù„ Ù†ÛŒØ³Øª.';
        updateCtaLink({category: catKey});
      }
    }

    function onSubplanChange(){
      const sel = getSelectedPlan();
      if(!sel) return;
      const { catKey, subKey, plan } = sel;
      updateAmountPlaceholder(plan.min);
      document.getElementById('result').textContent = '';
      setError('');
      updateCtaLink({category: catKey, sub: subKey});
    }

    // =======================
    // Calculation handler
    // =======================
    function calculate(){
      const cat = getSelectedCategory();
      const amountVal = document.getElementById('amount').value;
      const amount = numberFromInput(amountVal);
      const resultEl = document.getElementById('result');

      if(Number.isNaN(amount)){
        setError('Ù…Ø¨Ù„Øº Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.');
        return;
      }
      if(amount <= 0){
        setError('Ù…Ø¨Ù„Øº Ø¨Ø§ÛŒØ¯ Ø¨Ø²Ø±Ú¯â€ŒØªØ± Ø§Ø² ØµÙØ± Ø¨Ø§Ø´Ø¯.');
        return;
      }

      if(cat && cat.type === 'group'){
        const sel = getSelectedPlan();
        if(!sel){
          setError('Ø§Ø¨ØªØ¯Ø§ ÛŒÚ© Ø²ÛŒØ±Ø·Ø±Ø­ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯.');
          return;
        }
        const { catKey, subKey, plan } = sel;

        if(amount < plan.min){
          setError(`Ø­Ø¯Ø§Ù‚Ù„ Ù…Ø¨Ù„Øº Ø¨Ø±Ø§ÛŒ Â«${plan.label}Â» ${formatNumber(plan.min)} ØªÙˆÙ…Ø§Ù† Ø§Ø³Øª.`);
          return;
        }
        setError('');

        const out = calcTermYield(amount, plan.termYield, plan.termMonths);

        let text =
`Ø·Ø±Ø­: ${plan.label}
Ù…Ø¯Øª: ${plan.termMonths} Ù…Ø§Ù‡Ù‡
Ø³ÙˆØ¯ Ù…Ø§Ù‡Ø§Ù†Ù‡: ${formatNumber(out.monthly)} ØªÙˆÙ…Ø§Ù†
Ø³ÙˆØ¯ Ú©Ù„ Ø¯ÙˆØ±Ù‡: ${formatNumber(out.profit)} ØªÙˆÙ…Ø§Ù†
Ù…Ø¨Ù„Øº Ù‚Ø§Ø¨Ù„ Ø¨Ø±Ø¯Ø§Ø´Øª Ø¯Ø± Ø³Ø±Ø±Ø³ÛŒØ¯: ${formatNumber(out.finalAmount)} ØªÙˆÙ…Ø§Ù†`;

        // Ù‡Ø¯ÛŒÙ‡ Ø¨Ù„Ú© ÙØ±Ø§ÛŒØ¯ÛŒ (ÙÙ‚Ø· Ù…Ø¨Ù„ØºØŒ Ø¨Ø¯ÙˆÙ† Ø§Ø´Ø§Ø±Ù‡ Ø¨Ù‡ Ø¯Ø±ØµØ¯)
        const gift = calcGift(amount, catKey, subKey);
        if (gift && gift.totalGift > 0) {
          text += `

ğŸ Ø·Ø±Ø­ Ù‡Ø¯ÛŒÙ‡ Ø¨Ù„Ú© ÙØ±Ø§ÛŒØ¯ÛŒ:
Ù‡Ø¯ÛŒÙ‡ Ù†Ù‚Ø¯ÛŒ Ø§ØµÙ„ÛŒ: ${formatNumber(gift.baseGift)} ØªÙˆÙ…Ø§Ù†`;
          if (gift.extraGift > 0) {
            text += `
Ù¾Ø§Ø¯Ø§Ø´ Ù†Ù‚Ø¯ÛŒ ÙˆÛŒÚ˜Ù‡ Ø·Ø±Ø­ Û±Û±Û´Ùª: ${formatNumber(gift.extraGift)} ØªÙˆÙ…Ø§Ù†`;
          }
          text += `
Ø¬Ù…Ø¹ Ú©Ù„ Ù‡Ø¯ÛŒÙ‡ Ùˆ Ù¾Ø§Ø¯Ø§Ø´: ${formatNumber(gift.totalGift)} ØªÙˆÙ…Ø§Ù†`;
        }

        resultEl.textContent = text;
        updateCtaLink({category: catKey, sub: subKey, amount, months: plan.termMonths});
        incrementUseCountOnServer();
        triggerCoinRain();
      } else {
        resultEl.textContent = 'Ø§ÛŒÙ† Ø·Ø±Ø­ Ø¯Ø± Ø­Ø§Ù„ Ø­Ø§Ø¶Ø± ÙØ¹Ø§Ù„ Ù†ÛŒØ³Øª.';
      }
    }

    // =======================
    // Copy & share handlers
    // =======================
    async function copyResult(){
      const btn = document.getElementById('btnCopy');
      const text = document.getElementById('result').textContent.trim();
      if(!text){
        btn.style.transform='translateX(-3px)';
        setTimeout(()=>btn.style.transform='none',160);
        return;
      }
      try{
        await navigator.clipboard.writeText(text);
        const old=btn.textContent;
        btn.textContent='Ú©Ù¾ÛŒ Ø´Ø¯ âœ…';
        btn.disabled=true;
        setTimeout(()=>{
          btn.textContent=old;
          btn.disabled=false;
        },1500);
      }catch(_){}
    }

    async function shareResult(){
      const btn = document.getElementById('btnShare');
      const text = document.getElementById('result').textContent.trim();
      if(!text){
        btn.style.transform='translateX(-3px)';
        setTimeout(()=>btn.style.transform='none',160);
        return;
      }
      const url = document.getElementById('ctaStart').href;
      const payload = { title: 'Ù†ØªÛŒØ¬Ù‡ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø±ÛŒÙ¾ÛŒ', text, url };
      if(navigator.share){
        try{
          await navigator.share(payload);
          const old=btn.textContent;
          btn.textContent='Ø§Ø´ØªØ±Ø§Ú©â€ŒÚ¯Ø°Ø§Ø±ÛŒ Ø´Ø¯ âœ…';
          btn.disabled=true;
          setTimeout(()=>{
            btn.textContent=old;
            btn.disabled=false;
          },1500);
        }catch(_){}
      }else{
        try{
          await navigator.clipboard.writeText(text + '\n' + url);
          const old=btn.textContent;
          btn.textContent='Ù…ØªÙ† Ú©Ù¾ÛŒ Ø´Ø¯ âœ…';
          btn.disabled=true;
          setTimeout(()=>{
            btn.textContent=old;
            btn.disabled=false;
          },1500);
        }catch(_){}
      }
    }

    // =======================
    // Download modal
    // =======================
    function setupDownloadModal(){
      const modal = document.getElementById('downloadModal');
      const openBtn = document.getElementById('btnDownload');
      const closeBtn = document.getElementById('downloadClose');
      if (!modal || !openBtn || !closeBtn) return;

      function open(){
        modal.classList.add('active');
        modal.setAttribute('aria-hidden','false');
      }
      function close(){
        modal.classList.remove('active');
        modal.setAttribute('aria-hidden','true');
      }

      openBtn.addEventListener('click', open);
      closeBtn.addEventListener('click', close);
      modal.addEventListener('click', (e)=>{
        if(e.target === modal) close();
      });
    }

    // =======================
    // Init
    // =======================
    document.addEventListener('DOMContentLoaded', ()=>{
      // Ø´Ù…Ø§Ø±Ù†Ø¯Ù‡Ù” Ø³Ø±Ø§Ø³Ø±ÛŒ Ø§Ø² Google Apps Script
      fetchUseCountFromServer();

      // Ø¨Ø§Ø¯Ú©Ù†Ú© Ø§ÙˆÙ„ÛŒÙ‡ Ùˆ ØªÚ©Ø±Ø§Ø±Ø´
      spawnBalloon();
      setInterval(spawnBalloon, 8000 + Math.random()*4000);

      // Ù¾Ø± Ú©Ø±Ø¯Ù† Ø¯Ø³ØªÙ‡â€ŒÙ‡Ø§
      fillCategories();

      // Ù¾ÛŒØ´â€ŒÙØ±Ø¶: Ø·Ø±Ø­ Ø¨Ù„Ú© ÙØ±Ø§ÛŒØ¯ÛŒ
      const catSel = document.getElementById('category');
      catSel.value = 'blackFriday';
      onCategoryChange();

      document.getElementById('category').addEventListener('change', onCategoryChange);
      document.getElementById('subplan').addEventListener('change', onSubplanChange);
      document.getElementById('calcBtn').addEventListener('click', calculate);
      document.getElementById('amount').addEventListener('input', formatInputAmount);
      document.getElementById('amount').addEventListener('keydown', (e)=>{
        if(e.key === 'Enter'){
          e.preventDefault();
          calculate();
        }
      });
      document.getElementById('btnCopy').addEventListener('click', copyResult);
      document.getElementById('btnShare').addEventListener('click', shareResult);

      setupDownloadModal();
    });
  </script>
</body>
</html>
