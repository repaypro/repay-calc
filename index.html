<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ù…Ø§Ø´ÛŒÙ†â€ŒØ­Ø³Ø§Ø¨ Ø³ÙˆØ¯ Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±ÛŒ Ø±ÛŒÙ¾ÛŒ</title>
  <style>
    :root{
      --primary:#121212; --accent:#4332BD; --accent2:#E96742; --ink:#2d0c59;
      --muted:#666; --border:#ddd; --bg:#f5f5f5; --card:#fff;
      --radius:20px; --shadow:0 6px 20px rgba(0,0,0,.06);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{font-family:IranSans,system-ui,-apple-system,Segoe UI,Roboto,sans-serif;background:var(--bg);color:var(--ink);margin:0;padding:0;text-align:center}
    .container{max-width:460px;background:var(--card);margin:30px auto;padding:24px;border-radius:calc(var(--radius) + 5px);box-shadow:var(--shadow);text-align:right}
    img.logo{width:90px;display:block;margin:0 auto 10px}
    h1{font-size:22px;margin:10px 0;text-align:center}
    p{font-size:14px;margin:0 0 16px;line-height:1.9;text-align:center}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:6px}
    .row.onecol{grid-template-columns:1fr}
    label.mini{font-size:12px;color:var(--muted);display:block;margin:4px 2px}
    select,input[type="text"]{width:100%;padding:12px;margin-bottom:12px;font-size:15px;border-radius:12px;border:1px solid #ccc;text-align:right;background:#fff}
    input[type="text"]{direction:ltr}
    input[aria-invalid="true"]{border-color:#d33;outline-color:#d33}
    .error{color:#d33;font-size:12px;min-height:18px;margin:-6px 0 10px}
    .result{background:#fafafa;padding:18px;border-radius:14px;line-height:1.9;white-space:pre-line;min-height:80px}
    .btn{background:var(--primary);color:#fff;border:none;padding:14px;font-size:16px;border-radius:12px;cursor:pointer;width:100%;margin:8px 0 16px}
    .btn:active{transform:translateY(1px)}
    .btn-secondary{background:var(--accent)}
    .btn-ghost{background:#fff;color:#111;border:1px solid var(--border)}
    .actions{display:flex;gap:8px;margin-top:10px}
    .actions .btn{flex:1;padding:10px;margin:0}
    a.btn-primary{display:block;text-decoration:none;text-align:center;background:var(--primary);color:#fff;border-radius:12px;padding:14px;margin:8px 0 16px}
    a.btn-primary:active{transform:translateY(1px)}
    .usage-counter{margin-top:10px;font-size:14px;color:#555;text-align:center}
  </style>
</head>
<body>
  <div class="container">
    <img src="https://uploadkon.ir/uploads/8c7604_25file-0000000073346243969ca320550ec0a2.png" class="logo" alt="Repay Logo" />
    <h1>Ù…Ø§Ø´ÛŒÙ† Ø­Ø³Ø§Ø¨ Ø³ÙˆØ¯ Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±ÛŒ</h1>
    <p>Ø§Ø² Ø¨Ø§Ú©Ø³ Â«Ø·Ø±Ø­â€ŒÙ‡Ø§Â» Ú¯Ø²ÛŒÙ†Ù‡ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯Ø› Ø§Ú¯Ø± Ø²ÛŒØ±Ù…Ø¬Ù…ÙˆØ¹Ù‡ Ø¯Ø§Ø´ØªØŒ Ø¨Ø§Ú©Ø³ Ø¯ÙˆÙ… ÙØ¹Ø§Ù„ Ù…ÛŒâ€ŒØ´ÙˆØ¯.</p>

    <div style="margin-bottom:12px">
      <button id="btnOpenModal" type="button" class="btn btn-secondary">Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø§Ù¾Ù„ÛŒÚ©ÛŒØ´Ù†</button>
    </div>

    <div class="row" id="planRow">
      <div id="catWrap">
        <label class="mini" for="category">Ø·Ø±Ø­â€ŒÙ‡Ø§</label>
        <select id="category" aria-label="Ø·Ø±Ø­â€ŒÙ‡Ø§"></select>
      </div>
      <div id="subWrap" style="display:none">
        <label class="mini" for="subplan">Ø§Ù†ØªØ®Ø§Ø¨ Ø²ÛŒØ±Ø·Ø±Ø­ (Ù…Ø¯Øª/Ø¯Ø±ØµØ¯)</label>
        <select id="subplan" aria-label="Ø²ÛŒØ±Ø·Ø±Ø­"></select>
      </div>
    </div>

    <label class="mini" for="amount">Ù…Ø¨Ù„Øº Ø³Ø±Ù…Ø§ÛŒÙ‡ (ØªÙˆÙ…Ø§Ù†)</label>
    <input id="amount" type="text" inputmode="numeric" pattern="[0-9]*" autocomplete="off" placeholder="Ù…Ø¨Ù„Øº Ø³Ø±Ù…Ø§ÛŒÙ‡ (ØªÙˆÙ…Ø§Ù†)" aria-invalid="false" />
    <div id="amountError" class="error" aria-live="polite"></div>

    <button id="calcBtn" class="btn" type="button">Ù…Ø­Ø§Ø³Ø¨Ù‡</button>

    <div class="result" id="result" aria-live="polite"></div>

    <div class="actions">
      <button id="btnCopy" class="btn btn-ghost" type="button">ğŸ“‹ Ú©Ù¾ÛŒ Ù†ØªÛŒØ¬Ù‡</button>
      <button id="btnShare" class="btn btn-ghost" type="button">ğŸ“¤ Ø§Ø´ØªØ±Ø§Ú©â€ŒÚ¯Ø°Ø§Ø±ÛŒ</button>
    </div>

    <a id="ctaStart" class="btn-primary" href="https://my.repay.pro" target="_blank" rel="noreferrer noopener">Ù‡Ù…ÛŒÙ† Ø§Ù„Ø§Ù† Ø´Ø±ÙˆØ¹ Ú©Ù†</a>

    <div class="usage-counter">ğŸ“Š count : <span id="useCount">0</span></div>
  </div>

  <script>
    // ÙÙ‚Ø· Ø·Ø±Ø­ ÙˆÛŒÚ˜Ù‡ Ùˆ Ù‡Ù…Ø±Ø§Ù‡ÛŒ
    const catalog = {
      special: {
        type: 'group',
        label: 'ğŸ† Ø·Ø±Ø­ ÙˆÛŒÚ˜Ù‡',
        children: {
          gold114: { label: "ğŸ… ÙˆÛŒÚ˜Ù‡ Û±Û±Û´Ùª (Û²Û´Ù…Ø§Ù‡Ù‡)", type: "termYield", termMonths: 24, termYield: 1.14, min: 5_000_000 },
          gold52:  { label: "ğŸ… ÙˆÛŒÚ˜Ù‡ ÛµÛ²Ùª (Û±Û²Ù…Ø§Ù‡Ù‡)",  type: "termYield", termMonths: 12, termYield: 0.52, min: 5_000_000 },
          gold25:  { label: "ğŸ… ÙˆÛŒÚ˜Ù‡ Û²ÛµÙª (Û¶Ù…Ø§Ù‡Ù‡)",   type: "termYield", termMonths: 6,  termYield: 0.25, min: 5_000_000 },
          gold9:   { label: "ğŸ… ÙˆÛŒÚ˜Ù‡ Û¹Ùª (Û³Ù…Ø§Ù‡Ù‡)",    type: "termYield", termMonths: 3,  termYield: 0.09, min: 5_000_000 },
        }
      },
      hamrahi: { type: 'comingSoon', label: 'â™¥ï¸ Ø·Ø±Ø­ Ù‡Ù…Ø±Ø§Ù‡ÛŒ (Ø¨Ø²ÙˆØ¯ÛŒ)' }
    };

    const nfFA = new Intl.NumberFormat('fa-IR');
    const formatNumber = (n) => nfFA.format(n);

    function normalizeDigits(str){const fa='Û°Û±Û²Û³Û´ÛµÛ¶Û·Û¸Û¹', ar='Ù Ù¡Ù¢Ù£Ù¤Ù¥Ù¦Ù§Ù¨Ù©';return (str||'').replace(/[\u06F0-\u06F9\u0660-\u0669]/g,d=>{const i=fa.indexOf(d);if(i>-1)return String(i);const j=ar.indexOf(d);if(j>-1)return String(j);return d;});}
    function numberFromInput(val){const normalized = normalizeDigits(val);const raw = normalized.replace(/[^\d]/g,'');return raw ? parseInt(raw,10) : NaN;}
    function formatInputAmount(e){const input=e.target;const n=numberFromInput(input.value);if(Number.isNaN(n)){input.value='';return;}input.value=formatNumber(n);}
    function setError(msg){const el=document.getElementById('amountError');const inp=document.getElementById('amount');el.textContent=msg||'';inp.setAttribute('aria-invalid',msg?'true':'false');}

    function calcTermYield(P, termYield, termMonths){const profit=Math.round(P*termYield);const monthly=Math.round(profit/termMonths);return{profit,monthly,finalAmount:P+profit};}
    function updateAmountPlaceholder(min){const txt=min>0?`Ø­Ø¯Ø§Ù‚Ù„ Ù…Ø¨Ù„Øº ${formatNumber(min)} ØªÙˆÙ…Ø§Ù†`:'Ù…Ø¨Ù„Øº Ø³Ø±Ù…Ø§ÛŒÙ‡ (ØªÙˆÙ…Ø§Ù†)';document.getElementById('amount').placeholder=txt;}

    function onCategoryChange(){
      const catKey=document.getElementById('category').value;
      const cat=catalog[catKey];
      const subSel=document.getElementById('subplan');
      const calcBtn=document.getElementById('calcBtn');
      const resultEl=document.getElementById('result');
      subSel.innerHTML='';resultEl.textContent='';setError('');
      if(cat.type==='group'){
        Object.entries(cat.children).forEach(([k,pl])=>{
          const opt=document.createElement('option');
          opt.value=k;opt.textContent=pl.label;subSel.appendChild(opt);
        });
        subSel.style.display='';updateAmountPlaceholder(Object.values(cat.children)[0].min);
      }else{
        subSel.style.display='none';
        resultEl.textContent='Ø§ÛŒÙ† Ø·Ø±Ø­ Ø¯Ø± Ø­Ø§Ù„ Ø­Ø§Ø¶Ø± ÙØ¹Ø§Ù„ Ù†ÛŒØ³Øª.';
        calcBtn.disabled=true;
      }
    }

    function onSubplanChange(){
      const cat=catalog[document.getElementById('category').value];
      const subKey=document.getElementById('subplan').value;
      if(!cat.children[subKey])return;
      updateAmountPlaceholder(cat.children[subKey].min);
    }

    function calculate(){
      const catKey=document.getElementById('category').value;
      const cat=catalog[catKey];
      const amount=numberFromInput(document.getElementById('amount').value);
      if(Number.isNaN(amount)){setError('Ù…Ø¨Ù„Øº Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.');return;}
      if(cat.type!=='group'){setError('Ø·Ø±Ø­ Ø§Ù†ØªØ®Ø§Ø¨ÛŒ ÙØ¹Ø§Ù„ Ù†ÛŒØ³Øª.');return;}
      const subKey=document.getElementById('subplan').value;
      const plan=cat.children[subKey];
      if(amount<plan.min){setError(`Ø­Ø¯Ø§Ù‚Ù„ Ù…Ø¨Ù„Øº ${formatNumber(plan.min)} ØªÙˆÙ…Ø§Ù† Ø§Ø³Øª.`);return;}
      setError('');
      const out=calcTermYield(amount,plan.termYield,plan.termMonths);
      document.getElementById('result').textContent=
`Ù…Ø¯Øª: ${plan.termMonths} Ù…Ø§Ù‡Ù‡
Ø³ÙˆØ¯ Ù…Ø§Ù‡Ø§Ù†Ù‡: ${formatNumber(out.monthly)} ØªÙˆÙ…Ø§Ù†
Ø³ÙˆØ¯ Ú©Ù„: ${formatNumber(out.profit)} ØªÙˆÙ…Ø§Ù†
Ù…Ø¨Ù„Øº Ù†Ù‡Ø§ÛŒÛŒ: ${formatNumber(out.finalAmount)} ØªÙˆÙ…Ø§Ù†`;
    }

    document.addEventListener('DOMContentLoaded',()=>{
      const catSel=document.getElementById('category');
      Object.entries(catalog).forEach(([k,v])=>{
        const opt=document.createElement('option');
        opt.value=k;opt.textContent=v.label;
        catSel.appendChild(opt);
      });
      catSel.value='special';
      onCategoryChange();
      document.getElementById('category').addEventListener('change',onCategoryChange);
      document.getElementById('subplan').addEventListener('change',onSubplanChange);
      document.getElementById('calcBtn').addEventListener('click',calculate);
      document.getElementById('amount').addEventListener('input',formatInputAmount);
    });
  </script>
</body>
</html>
